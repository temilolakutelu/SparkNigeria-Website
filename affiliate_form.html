<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Affiliate Sales Form</title>

    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <!-- Responsive File -->
    <link href="css/responsive.css" rel="stylesheet">

    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <link rel="icon" href="images/favicon.png" type="image/x-icon">

    <!-- Responsive Settings -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
</head>

<body>

    <div class="page-wrapper">


        <!-- Main Header -->
        <header class="main-header header-style-four">

            <!-- Header Upper -->
            <div class="header-main-box">
                <div class="header-upper">
                    <div class="auto-container">
                        <div class="inner clearfix">
                            <!--Logo-->
                            <div class="logo-box">
                                <div class="logo">
                                    <a href="index.html" title="Sparknigeria HTML Template"><img src="images/logo.png" alt="Spark Nigeria" title="Sparknigeria"></a>
                                </div>
                            </div>

                            <!--Social-->
                            <div class="social">
                                <ul class="social-links clearfix">
                                    <li><a href="https://twitter.com/share?text=Spark Nigeria&url=https%3A%2F%2Fsparknigeria.co%2F"><span class="fab fa-twitter"></span></a></li>
                                    <li><a href="#"><span class="fab fa-facebook-f"></span></a></li>
                                    <li><a href="#"><span class="fab fa-instagram"></span></a></li>
                                </ul>
                            </div>

                            <div class="nav-outer clearfix">
                                <!--Mobile Navigation Toggler-->
                                <div class="mobile-nav-toggler"><span class="icon flaticon-menu-1"></span></div>

                                <!-- Main Menu -->
                                <nav class="main-menu navbar-expand-md navbar-light">
                                    <div class="collapse navbar-collapse show clearfix" id="navbarSupportedContent">
                                        <ul class="navigation clearfix">
                                            <li><a href="index.html">Home</a>

                                            </li>
                                            <li><a href="about.html">About Us</a> </li>
                                            <li><a href="pitch_a_project.html">Pitch A Project</a></li>
                                            <li class="dropdown"><a href="#">Services</a>
                                                <ul>
                                                    <li><a href="power_bug.html">Power Bug</a></li>
                                                    <li><a href="energy_exchange.html">Energy Exchange</a></li>

                                                </ul>
                                            </li>


                                            <li class="current"><a href="contact.html">Contact</a></li>
                                        </ul>
                                    </div>
                                </nav>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
            <!--End Header Upper-->

            <!-- Sticky Header  -->
            <div class="sticky-header">
                <div class="auto-container clearfix">
                    <!--Logo-->
                    <div class="logo pull-left">
                        <a href="index.html" title=""><img src="images/sticky-logo.png" alt="" title=""></a>
                    </div>
                    <!--Right Col-->
                    <div class="pull-right">
                        <!-- Main Menu -->
                        <nav class="main-menu clearfix">
                            <!--Keep This Empty / Menu will come through Javascript-->
                        </nav>
                        <!-- Main Menu End-->
                    </div>
                </div>
            </div>
            <!-- End Sticky Menu -->

            <!-- Mobile Menu  -->
            <div class="mobile-menu">
                <div class="menu-backdrop"></div>
                <div class="close-btn"><span class="icon flaticon-cancel"></span></div>

                <nav class="menu-box">
                    <div class="nav-logo">
                        <a href="index.html"><img src="images/logo.png" alt="" title=""></a>
                    </div>
                    <div class="menu-outer">
                        <!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header-->
                    </div>
                    <!--Social Links-->
                    <div class="social-links">
                        <ul class="clearfix">
                            <li><a href="https://twitter.com/share?text=Spark Nigeria&url=https%3A%2F%2Fsparknigeria.co%2F"><span class="fab fa-twitter"></span></a></li>
                            <li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
                            <li><a href="#"><span class="fab fa-instagram"></span></a></li>
                        </ul>
                    </div>
                </nav>
            </div>
            <!-- End Mobile Menu -->
        </header>
        <!-- End Main Header -->




        <!-- Page Banner Section -->
        <section class="page-banner">
            <div class="image-layer" style="background-image: url(images/background/banner-bg-1.jpg);"></div>

            <div class="auto-container">


                <h1>Affiliates Sales Form</h1>
            </div>

        </section>
        <!--End Page Banner Section -->

        <!--Contact Section-->
        <section class="sales_form container my-5">
            <div class="card">
                <form id="earning_form" class="card-body p-sm-5">
                    <div class="form-row">
                        <div class="form-group col-sm-6">
                            <label>Affiliate</label>
                            <select id="list" name="affiliateID" class="form-control">
                            <option selected hidden>Select Affiliate</option>
                        </select>
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Sale Type</label>
                            <select name="sale_type" class="form-control">
                            <option selected hidden>Select Sale Type</option>
                            <option >Outright sale of inverter unit</option>
                            <option >Lease to own sale of inverter unit</option>
                            <option >Sale of energy as a service</option>
                        </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-sm-6">
                            <label>Duration of earnings</label>
                            <select name="earning_duration" class="form-control">
                            <option selected hidden>Select Earning Duration</option>
                            <option> One off</option>
                            <option> 5 years</option>
                        </select>
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Earnings on sale(5% of sale value in NGN </label>
                            <input type="text" name="sale_earnings" class="form-control" placeholder="Enter sale earning">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-sm-6">
                            <label>Date of Sale </label>
                            <input type="date" name="date_of_sale" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn btn-success">Submit</button>
                    </div>
                </form>
            </div>
        </section>


        <!-- Main Footer / Style Two-->
        <footer class="main-footer footer-style-two">

            <!--Widgets Section-->
            <div class="widgets-section">
                <div class="auto-container">
                    <div class="row clearfix">

                        <!--Column-->
                        <div class="footer-column col-lg-4 col-md-5 col-sm-12">
                            <div class="footer-widget about-widget">
                                <div class="footer-logo-box">
                                    <a href="index.html" title="Spark Nigeria"><img src="images/footer-logo.png" alt="Spark Nigeria" title="Spark Nigeria"></a>
                                </div>

                                <div class="footer-social">
                                    <ul class="footer-social-two clearfix">
                                        <li><a href="#"><span class="fab fa-twitter"></span></a></li>
                                        <li><a href="#"><span class="fab fa-facebook-f"></span></a></li>
                                        <li><a href="#"><span class="fab fa-instagram"></span></a></li>
                                        <li><a href="#"><span class="fab fa-linkedin-in"></span></a></li>
                                        <li><a href="#"><span class="fab fa-pinterest-p"></span></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!--Column-->
                        <div class="big-column col-lg-5 col-md-7 col-sm-12">
                            <div class="row clearfix">
                                <!--Column-->
                                <div class="footer-column col-lg-6 col-md-6 col-sm-12">
                                    <div class="footer-widget links-widget">
                                        <div class="widget-title">
                                            <h3>Quick Links</h3>
                                        </div>
                                        <div class="widget-content">
                                            <ul>
                                                <li><a href="#">About Us</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!--Column-->
                                <div class="footer-column col-lg-6 col-md-6 col-sm-12">
                                    <div class="footer-widget links-widget">
                                        <div class="widget-title">
                                            <h3>Our Services</h3>
                                        </div>
                                        <div class="widget-content">
                                            <ul>
                                                <li><a href="#">Pitch A Project</a></li>
                                                <li><a href="#">Power Bug Energy</a></li>
                                                <li><a href="#">Energy Exchange</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Column-->
                        <div class="footer-column col-lg-3 col-md-12 col-sm-12">
                            <div class="footer-widget gallery-widget">
                                <div class="widget-title">
                                    <h3>Contact Us</h3>
                                </div>
                                <div class="info">

                                    <!--Info Block-->
                                    <div class="info-block">
                                        <div class="icon-box">
                                            <span class="icon">
                                            <img src="images/icons/icon-call-1.png" alt="">
                                        </span>
                                        </div>
                                        <strong>Phone Inquiry</strong>
                                        <div class="info-text">
                                            <a href="tel:+2348077881170">+2348077881170</a>
                                        </div>
                                    </div>
                                    <!--Info Block-->
                                    <div class="info-block">
                                        <div class="icon-box">
                                            <span class="icon">
                                            <img src="images/icons/icon-mail-1.png" alt="">
                                        </span>
                                        </div>
                                        <strong>Send Email</strong>
                                        <div class="info-text">
                                            <a href="mailto:info@sparknigeria.co">info@sparknigeria.co</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="auto-container">

                    <div class="inner clearfix">
                        <!--Scroll to top-->
                        <div class="scroll-top-footer scroll-to-target" data-target="html"><span class="flaticon-arrows"></span></div>
                        <!--Copyright-->
                        <div class="copyright">(c) 2022 <a href="#">SPARK NIGERIA</a> Company. All rights reserved.</div>
                        <div class="footer-nav">
                            <ul class="clearfix">
                                <li><a href="privacy.html">Privacy Policy</a></li>
                            </ul>
                        </div>
                    </div>

                </div>
            </div>

        </footer>

    </div>
    <!--End pagewrapper-->



    <script src="js/jquery.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/jquery.fancybox.js"></script>
    <script src="js/appear.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/scrollbar.js"></script>
    <script src="js/validate.js"></script>
    <script src="js/paroller.js"></script>
    <script src="js/element-in-view.js"></script>
    <script src="js/custom-script.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6LcLOlMiAAAAANvxCU24fYZ7K2tWOMMpztXN_oW5"></script>

    <script>
        $(document).ready(function() {
            getAffiliates()
            $('#earning_form').submit((e) => {
                e.preventDefault();
                grecaptcha.ready(function() {
                    grecaptcha.execute('6LcLOlMiAAAAANvxCU24fYZ7K2tWOMMpztXN_oW5', {
                        action: 'submit'
                    }).then(function(token) {
                        // Add your logic to submit to your backend server here.
                        var loading_html =
                            '<div style="height:150px;width:150px;margin: 0 auto;"><img style="width: 100%;" src="https://skiracing.com.au/wp-content/plugins/NeoGallery26-09-2018-340/img/ajax-loader.gif" /></div>';
                        Swal.fire({
                            html: loading_html,
                            showConfirmButton: false,
                            showCancelButton: false
                        })

                        var data = new FormData();

                        data.append('date_of_sale', $('input[name="date_of_sale"]').val())
                        data.append('sale_type', $('select[name="sale_type"]').val())
                        data.append('sale_earnings', $('input[name="sale_earnings"]').val())
                        data.append('earning_duration', $('select[name="earning_duration"]').val())
                        data.append('affliateID', $('select[name="affiliateID"]').val())

                        createRecord(data)
                    })
                });
            })

            function getAffiliates() {

                axios.get(`https://sparknigeria.herokuapp.com/api/affliates`)
                    .then(function(response) {
                        if (response.data.status) {
                            let affiliates = response.data.data
                            affiliates.forEach((i, ix) => {
                                $('#list').append('<option value="' + i.id + '">' + i.fullname + '</option>')
                            })
                        } else {
                            Swal.fire({
                                title: 'Error!',
                                text: response.data.message,
                                icon: 'error'
                            })
                        }




                    })
                    .catch(function(error) {
                        console.log(error);
                        Swal.fire({
                            title: 'Error!',
                            text: error.message,
                            icon: 'error'
                        })
                    });
            }

            function createRecord(data) {
                // for (let i of data.entries()) {
                //     console.log(i[0] + '  =>  ' + i[1])
                // }
                axios.post('https://sparknigeria.herokuapp.com/api/salesearnings/', data)
                    .then(function(response) {
                        if (response.data.status) {
                            Swal.fire({
                                title: 'Success!',
                                text: response.data.message,
                                icon: 'success'
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    location.reload()
                                }
                            })
                        } else {
                            Swal.fire({
                                title: 'Error!',
                                text: response.data.message,
                                icon: 'error'
                            })
                        }




                    })
                    .catch(function(error) {
                        console.log(error);
                        Swal.fire({
                            title: 'Error!',
                            text: error.message,
                            icon: 'error'
                        })
                    });
            }
        })
    </script>
</body>

</html>